<include file="Common/header"/>
<div>

	<include file="Common/topbar"/>


	<div id="wrapper">
		<!--BEGIN SIDEBAR MENU-->
		<include file="Common/sidebar"/>
		<!--END SIDEBAR MENU-->
          
        <!--BEGIN PAGE WRAPPER-->
        <div id="page-wrapper">

			<!--BEGIN TITLE & BREADCRUMB PAGE-->

			<div class="page-title-breadcrumb option-demo">
				<div class="page-header pull-right">
					<div class="page-toolbar">
						<a type="button" href="{:U('Admin/Blog/index')}" title="" class="btn btn-success" >
							博客管理
						</a>
						<a type="button" href="{:U('Admin/Bgtag/index')}" title="" class="btn btn-success" >
							博客标签管理
						</a>
					</div>
				</div>
				<ol class="breadcrumb page-breadcrumb pull-left">					
					<li>
						<a href="{:U('Admin/Blog/index')}">博客管理</a>/
					</li>
					<li>编辑博客 </li>
				</ol>
				<div class="clearfix">
				</div>
			</div>

			<!--END TITLE & BREADCRUMB PAGE-->


            <!--BEGIN CONTENT-->
            <div class="page-content">
         		<div id="tab-general">
					<div class="row">
						<div class="col-lg-12">
							<div class="portlet box">
								<div class="portlet-body" id="user-edit-information">
								
									<form action="{:U('Admin/Blog/edit_run')}" method="post" class="form-horizontal" enctype="multipart/form-data">
										<h3>博客编辑</h3><hr/>
										<div class="form-group">
											<label class="col-sm-3 control-label">博客标题</label>
											<div class="col-sm-9 controls">
												<div class="row">
													<div class="col-xs-9">
														<input type="text" name="title" required placeholder="博客标题" class="form-control" value="{$item['title']}"/>
														<div class="text-red">标题少于30字</div>
													</div>
												</div>
											</div>
										</div>
										<div class="form-group"><label class="col-sm-3 control-label">原有缩略图片</label>
											<div class="col-sm-9 controls">
												<if condition="!empty($item['thumb']) && file_exists($item['thumb'])">
													<img class="img-responsive img-thumbnail"  src="__ROOT__/{$item['thumb']}">
												<else/>
													<img class="img-responsive img-thumbnail"  src="__PUBLIC__/img/default_avatar.jpg">
												</if>
											</div>
										</div>
										<div class="form-group"><label class="col-sm-3 control-label">缩略图片</label>
											<div class="col-sm-9 controls">
												<div class="row">
													<div class="col-xs-9">
														<input type="file" name="thumb" required  class="form-control"/>
														<div class="text-red">缩略图为350*220的等比大图</div>
													</div>
												</div>
											</div>
										</div>
										<div class="form-group"><label class="col-sm-3 control-label">简要说明</label>
											<div class="col-sm-9 controls">
												<textarea class="form-control" name="blog_info"  rows="3">{$item['blog_info']}</textarea>
												<div class="text-red">简要说明请少于75个字，不填默认去博客前75个字</div>
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-3 control-label">博客内容</label>
											<div class="col-sm-9 controls">
												<textarea id="editor" name="content" placeholder="博客内容" required autofocus>{$item['content']}</textarea>
												<div class="text-red">图片尺寸为800*600的等比大图,博客内容请大于200字</div>
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-3 control-label">标签选择</label>

											<div class="col-sm-9 controls">
												<div class=" info-checkbox">
													<volist name="list" id="vo">
															<label >
																<input type="checkbox" value="{$vo['id']}" name="tags[]"
																	<volist name="item['tags']" id="vos">
																		<if condition="$vo['id'] eq $vos[key]">
																			checked="checked"
																		</if>
																	</volist>
																/>
																{$vo['name']}
															</label>
													</volist>
												</div>
											</div>
										</div>
										<div class="form-group"><label class="col-sm-3 control-label">是否推荐</label>
											<div class="col-sm-9 controls">
												<div class="info-radio">
													<label >
														<input type="radio" value="0" name="recommend" <if condition="$item['recommend'] eq 0"> checked="checked"</if>/>不推荐
													</label>
													<label >
														<input type="radio" value="1" name="recommend" <if condition="$item['recommend'] eq 1"> checked="checked"</if>/>推荐
													</label>
												</div>
											</div>
										</div>
										<div class="form-group"><label class="col-sm-3 control-label">是否显示</label>
											<div class="col-sm-9 controls">
												<div class="info-radio">
													<label >
														<input type="radio" value="0" name="status" <if condition="$item['status'] eq 0"> checked="checked"</if>/>不显示
													</label>
													<label >
														<input type="radio" value="1" name="status" <if condition="$item['status'] eq 1"> checked="checked"</if>/>显示
													</label>
												</div>
											</div>
										</div>
										<hr/>
										<div class="form-group">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="hidden" name="id" required  value="{$item['id']}" class="form-control"/>
												<button type="submit" class="btn btn-green btn-block">确认</button>
											</div>
										</div>
									</form>
	
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
	                	<!--END CONTENT-->


	                	<!--BEGIN FOOTER-->
			<include file="Common/footer"/>
	               	<!--END FOOTER-->
        </div>
        <!--END PAGE WRAPPER-->
	</div>
</div>




<div class="modal fade post-now"  tabindex="-1" role="dialog" aria-labelledby="notice-now">
		<div class="modal-dialog" role="document">
			<div class="modal-content my-modal-content">
				
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title text-center" id="myTou">
						添加新博客标签
					</h4>
				</div>
				<form class="form-horizontal" method="post">
					<div class="modal-body">
						
	            		<p class="text-left" for="post-title">分享标题<span class="text-danger">(*标签名称请在2-20位之间)</span></p>
	            		<input type="text" class="form-control my-model-input" name="ta_name" id="post-title">
					     

					</div>
				</form>
				<div class="modal-footer">
					<button class="btn btn-success btn-block my-modal-btn send-tag">
						确定操作
					</button>
				</div>
				
			</div>
		</div>
	</div>

	<link type="text/css" rel="stylesheet" href="__PUBLIC__/pluge/simditor-2.3.6/styles/simditor.css">
	<script src="__PUBLIC__/pluge/simditor-2.3.6/scripts/module.js"></script>
	<script src="__PUBLIC__/pluge/simditor-2.3.6/scripts/hotkeys.js"></script>
	<script src="__PUBLIC__/pluge/simditor-2.3.6/scripts/uploader.js"></script>
	<script src="__PUBLIC__/pluge/simditor-2.3.6/scripts/simditor.js"></script>
	<script>
		$(function(){
			$('#side-menu>li').removeClass('active');
			$('#admin-blog').addClass('active');

			var toolbar =['title','bold','italic','underline','strikethrough',
				'fontScale','color','ol','ul','blockquote','code','table','link','image',
			    'hr','indent','outdent','alignment'];
			var editor = new Simditor({
				textarea: $('#editor'),
				placeholder		: "博客生涯从此开始...",
				toolbar			: true,
				toolbarFloat		: true,
				toolbarFloatOffset: 0,
				toolbarHidden		: false,
				defaultImage		: 'images/image.png',
				tabIndent			: true,
				params				: {},/*Insert a hidden input in textarea to store params (key-value pairs). Usually used as the default params of the form. It will generate：<input type="hidden" name="key" value="val" />*/
				upload:{
					url					: "{:U('Admin/Blog/img_up_blog')}",
					params				: null,
					fileKey			: 'blog_img',
					connectionCount	: 3,
					leaveConfirm		: '图片正在上传,真要离开吗?',
				},
				pasteImage 		: true,
			//optional options
			});


		});
	</script>

<!--
	<script src="__PUBLIC__/pluge/simditor-2.3.6/Face/scripts/jquery-2.1.1.min.js"></script>
	<script src="__PUBLIC__/pluge/simditor-2.3.6/Face/scripts/bootstrap.min.js"></script>
	
	<script>
		$('#add-tag').click(function(){
			$('.post-now').modal('show');
		});
		
		$('.send-tag').click(function(){
			var ta_name=$.trim($('input[name="ta_name"]').val());
			if(ta_name.length>1 && ta_name.length<=20){
				
				$.ajax({
					type:'post',
					url:"{:U('Bgtag/ajaxAddRun')}",
					data:{
						'ta_name':ta_name,
					},
					dataType:"json",
					success:function(data){
						if(data.code){
							$('.post-now').modal('hide');
//							alert(data.mess);
							
							$('#b_tag').append(ta_name+',');
							
							return;
						}else{
							alert(data.mess);
							return;
						}
					},
				});
			}else{
				alert('标签名必须在2-20位之间');
			}
		});
		
		$('.use-tag').click(function(){
			var ta_name=$.trim($(this).html());
			var ta_id=parseInt($(this).attr('attr'));
			$.ajax({
				type:'post',
				url:"{:U('Bgtag/ajaxSaveRun')}",
				data:{
					'ta_id':ta_id,
				},
				dataType:"json",
				success:function(data){
					if(data.code){
						alert(data.mess);
						$('span[attr='+ta_id+']').hide();
						$('#b_tag').append(ta_name+',');
						return;
					}else{
						alert(data.mess);
						return;
					}
				},
			});
		});
		
	</script>
	-->
	
</body>
</html>
